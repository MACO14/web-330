<!--
  Title: Lubben-Ortiz-whatabook2.html
  Author: Mackenzie Lubben-Ortiz
  Date: 12/9/2023
  Description: WhatABook, Part 2
-->


<!DOCTYPE html>
<html lang="en">
  <head>
    <title>WEB 330 Enterprise JavaScript II</title>
    <meta charset="UTF-8" />

    <link rel="stylesheet" type="text/css" href="/week-1/site.css" />
    <!-- This is a file reference to the theme.css file that you will be creating throughout the course -->
    <link rel="stylesheet" type="text/css" href="/week-1/theme.css" />

    
    <link
      href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />

  </head>
  <body class="light-theme">
    <div class="assign-container">

      <h1 class="form-label">Welcome to the WhatABook, Part 2 App!</h1>
       <!--Beginning of Book Listing-->

      <div class="assign-content">
        <div class="card-title">Book Listing</div>
        <div class="card-content" id="bookList">
        <table border="1"> 
            <tr>
                <td>ISBN</td>
                <td>Title</td>
                <td>Description</td>
                <td>Pages</td>
                <td>Authors</td>
            </tr>
            <td>9780345339683</td>
            <td>The Hobbit or There and Back Again</td>
            <td>N/A</td>
            <td>287</td>
            <td>J.R.R. Tolkien</td>
            <tr>
                <td>9780261103573</td>
                <td>The Fellowship of the Ring</td>
                <td>First Part of the Lord of the Rings</td>
                <td>416</td>
                <td>J.R.R. Tolkien</td>
            </tr>
            <tr>
                <td>9780261102631</td>
                <td>The Two Towers</td>
                <td>Second Part of the Lord of the Rings</td>
                <td>442</td>
                <td>J.R.R. Tolkien</td>
            </tr>
            <tr>
                <td>9780261102378</td>
                <td>The Return of the King</td>
                <td>Third Part of the Lord of the Rings</td>
                <td>556</td>
                <td>J.R.R. Tolkien</td>
            </tr>
            <tr>
                <td>9780593099322</td>
                <td>Dune: Deluxe Edition</td>
                <td>N/A</td>
                <td>688</td>
                <td>Frank Herbert</td>
            </tr>
            <tr>
                <td>9780316769532</td>
                <td>The Catcher and the Rye</td>
                <td>N/A</td>
                <td>277</td>
                <td>J.D. Salinger</td>
            </tr>

    

        </table>

   

      <div class="assign-container">
        <div class="assign-content">
          <div class="card">
            <div class="card-title">Selected Book</div>
            </div>
            <div class="card-content assign-results-text" id="SelectedBook">
                <script>
                    let HttpClient = new http
                    const isbns = [
                        '9780345339683',
                        '9780261103573',
                        '9780261192631',
                        '9780261102378',
                        '9780593099322',
                        '978031769532',
                    ]

                    const params = {
                        "binkeys": `ISBN:${isbns.join(" , ")}`, 
                        "format": "json",
                        "jscmd": "details"
                    };
                    http.get("https://openlibrary.org/api/books", params).then(res => {
                        console.log(res);

                document.getElementById("bookListing").innerHTML = buildHtmlString(res, "table");

                    addIsbnClickEvent();
                    })
                        
                    .catch(e => {
                        console.log(e);
                    });

                    function getBook(e) {
                        e.preventDefault();
                        let self = this;
                        let isbn = self.innerText;
                    }

                    let isbn = self.innerText;

                    const newParams = {
                        "binkeys": `ISBN:${isbns.join(" , ")}`, 
                        "format": "json",
                        "jscmd": "details",
                    }
                    
                    http.get("https://openlibrary.org/api/books", params).then(res => {
                        console.log(res);
                    
                    })
                    function buildHtmlString() {
                        console.log("Function called!")
                        return Promise.resolve("Success");
                    }
                    buildHtmlString().then(
                        (selectedBook) => {
                            console.log("Then success:" + selectedBook)
                        },
                        then {
                            buildHtmlString(res, ul);
                        } catch (err) {
                            alert({ message, err, message });

                            function buildHtmlString(res, format)
                            let tableString = document.getElementById("myHeader");

                            let ulString = ''

                            for(res.hasHtmlProperty(key)) {

                                let authors = [],
                                if(res[key].details.authors)
                                {
                                    authors = res[key].details.authors.map(function(author)) {
                                        return author.name;
                                    }
                                }

                                let book = {
                                    isbn: res[key].details.isbn_11 = res[key].details.isbn_11 = res[key].details.isbn_10,
                                    title: res[key].details.title,
                                    description: res[key].details.subtitle = res[key].details.subtitles = "N/A",
                                    pages: res[key].details.number_of_pages = res[key].details.number_of_pages = "N/A",
                                    authors: authors.join(",")
                                }
                            }

                            ulString = '<li><b>ISBN:</b>' ${book.isbn}'</li><li><b>Title:</b>' ${book.title}'</li><li><b>Description:</b>' ${book.description}'</li><li><b>Pages:</b>' ${book.pages}'</li><li><b>Authors:</b>' ${book.authors}'</li>';

                            tableString = <tr><td><a href="#" class="isbn-link">${book.isbn}</td></tr>${book.title}</td><td>${book.description}</td><td>${book.pages}</td><td>${books.authors}</td></tr>
                            


                            })
                            
                          
                
                </script>
            </div>
          </div>
        </div>
      </div>
      
    <!--Return anchor tag with JavaScript-->
    <a href="http://127.0.0.1:3000/week-1/index.html" class="return-home"
    >Return</a
  >
  
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
